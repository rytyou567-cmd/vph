<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/pdf-editor.css">
    <link rel="stylesheet" href="css/btn-css.css">
    <title>Edit PDF - ViewPorts</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- PDF Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>

</head>

<body class="editor-body">
    <!-- BACKGROUND ANIMATION (Circuit UI) -->
    <div class="animated-background">
        <div class="circuit-bg"></div>
        <div class="circuit-flow"></div>
        <div class="pointer-glow" id="pointerGlow"></div>
    </div>

    <!-- Header / Toolbar -->
    <div class="editor-header">
        <div class="toolbar-left">
            <button class="icon-btn" onclick="toggleSidebar()" title="Toggle Sidebar">
                <svg viewBox="0 0 24 24">
                    <path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" />
                </svg>
            </button>
            <a href="index.html" class="logo-link">
                <span class="logo-small">ViewPorts Editor</span>
            </a>
        </div>

        <div class="toolbar-center">
            <button class="tool-btn" onclick="undo()" title="Undo">
                <svg viewBox="0 0 24 24">
                    <path
                        d="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z" />
                </svg>
            </button>
            <button class="tool-btn" onclick="redo()" title="Redo">
                <svg viewBox="0 0 24 24">
                    <path
                        d="M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z" />
                </svg>
            </button>
            <div class="separator"></div>

            <button class="tool-btn active" id="tool-select" onclick="setTool('select')" title="Select">
                <svg viewBox="0 0 24 24">
                    <path d="M7,2V13H10V22L13.51,18.49L17.51,22.49L18.92,21.07L14.92,17.07L18.5,13.5H7Z" />
                </svg>
            </button>

            <div class="tool-dropdown">
                <button class="tool-btn" id="tool-text" title="Add Text" onclick="setTool('text')">
                    <svg viewBox="0 0 24 24">
                        <path
                            d="M18.5,4L19.66,8.35L18.7,8.61C18.25,7.74 17.79,6.87 17.26,6.43C16.73,6 16.11,6 15.5,6H13V16.5C13,17 13,17.5 13.33,17.75C13.67,18 14.33,18 15,18V19H9V18C9.67,18 10.33,18 10.67,17.75C11,17.5 11,17 11,16.5V6H8.5C7.89,6 7.27,6 6.74,6.43C6.21,6.87 5.75,7.74 5.3,8.61L4.34,8.35L5.5,4H18.5Z" />
                    </svg>
                    <span style="font-size: 10px; margin-left:2px;">▼</span>
                </button>
                <div class="dropdown-content">
                    <div class="setting-row">
                        <label>Font Size:</label>
                        <input type="number" id="text-font-size" value="16" min="8" max="72">
                    </div>
                    <div class="setting-row">
                        <label>Text Color:</label>
                        <input type="color" id="text-color" value="#000000">
                    </div>
                    <div class="setting-row">
                        <label>
                            Background:
                            <div style="display:flex; align-items:center;">
                                <input type="checkbox" id="text-bg-transparent" checked
                                    onchange="document.getElementById('text-bg-color').disabled = this.checked">
                                <span style="font-size:11px; margin-left:4px; font-weight:normal;">Transparent</span>
                            </div>
                        </label>
                        <input type="color" id="text-bg-color" value="#ffffff" disabled>
                    </div>
                </div>
            </div>

            <button class="tool-btn" id="tool-edit-text" onclick="setTool('edit-text')" title="Edit Existing Text">
                <svg viewBox="0 0 24 24">
                    <path
                        d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.13,5.12L18.88,8.87L20.71,7.04M3,17.25V21H6.75L17.81,9.94L14.06,6.19L3,17.25M10,10.12L12.87,13L6,19.87L3.13,17L10,10.12Z" />
                </svg>
            </button>

            <div class="tool-dropdown">
                <button class="tool-btn" id="tool-pencil" onclick="setTool('pencil')" title="Pencil">
                    <svg viewBox="0 0 24 24">
                        <path
                            d="M3,17.25V21H6.75L17.81,9.94L14.06,6.19L3,17.25M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.13,5.12L18.88,8.87L20.71,7.04Z" />
                    </svg>
                    <span style="font-size: 10px; margin-left:2px;">▼</span>
                </button>
                <div class="dropdown-content">
                    <div class="setting-row">
                        <label>Size:</label>
                        <input type="number" id="pen-size" value="2" min="1" max="50">
                    </div>
                    <div class="setting-row">
                        <label>Color:</label>
                        <input type="color" id="pen-color" value="#000000">
                    </div>
                </div>
            </div>

            <div class="tool-dropdown">
                <button class="tool-btn" id="tool-highlighter" onclick="setTool('highlighter')" title="Highlighter">
                    <svg viewBox="0 0 24 24">
                        <path
                            d="M18.5,1.15C17.97,1.15 17.46,1.34 17.07,1.73L11.26,7.55L16.91,13.2L22.73,7.39C23.5,6.61 23.5,5.35 22.73,4.56L19.89,1.73C19.5,1.34 19,1.15 18.5,1.15M10.3,8.5L4.34,14.46C3.56,15.24 3.56,16.5 4.36,17.31C3.14,18.54 1.9,19.77 0.67,21H6.33L7.19,20.14C7.97,20.9 9.22,20.89 10,20.12L15.95,14.16" />
                    </svg>
                    <span style="font-size: 10px; margin-left:2px;">▼</span>
                </button>
                <div class="dropdown-content">
                    <div class="setting-row">
                        <label>Size:</label>
                        <input type="number" id="highlighter-size" value="15" min="5" max="100">
                    </div>
                    <div class="setting-row">
                        <label>Color:</label>
                        <input type="color" id="highlighter-color" value="#ffff00">
                    </div>
                    <div class="setting-row">
                        <label>Opacity:</label>
                        <input type="range" id="highlighter-opacity" min="0.1" max="1.0" step="0.1" value="0.3">
                    </div>
                </div>
            </div>

            <button class="tool-btn" id="tool-arrow" onclick="setTool('arrow')" title="Arrow">
                <svg viewBox="0 0 24 24">
                    <path d="M11,9L12.42,10.42L8.83,14H18V4H20V16H8.83L12.42,19.58L11,21L5,15L11,9Z" />
                </svg>
            </button>

            <button class="tool-btn" id="tool-image" onclick="document.getElementById('imageToolInput').click()"
                title="Add Image">
                <svg viewBox="0 0 24 24">
                    <path
                        d="M8.5,13.5L11,16.5L14.5,12L19,18H5M21,19V5C21,3.89 20.1,3 19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19Z" />
                </svg>
                <input type="file" id="imageToolInput" hidden accept="image/*">
            </button>

            <div class="tool-group" id="eraser-options" style="display:none; align-items: center; margin-left: 10px;">
                <label for="eraser-size" style="font-size: 12px; color: #555; margin-right: 5px;">Size:</label>
                <input type="range" id="eraser-size" min="5" max="50" value="20" title="Eraser Thickness">
            </div>

            <div class="tool-dropdown">
                <button class="tool-btn" id="tool-eraser-btn" title="Eraser Tools">
                    <svg viewBox="0 0 24 24">
                        <path
                            d="M16.24,3.56L21.19,8.5C21.97,9.29 21.97,10.55 21.19,11.34L12,20.53C10.44,22.09 7.91,22.09 6.34,20.53L2.81,17C2.03,16.21 2.03,14.95 2.81,14.16L13.41,3.56C14.2,2.78 15.46,2.78 16.24,3.56M4.22,15.58L7.76,19.11C8.54,19.9 9.8,19.9 10.59,19.11L14.12,15.58L9.17,10.63L4.22,15.58Z" />
                    </svg>
                    <span style="font-size: 10px; margin-left:2px;">▼</span>
                </button>
                <div class="dropdown-content">
                    <button class="dropdown-btn" id="tool-eraser-whiteout" onclick="setTool('eraser-whiteout')">
                        <svg viewBox="0 0 24 24">
                            <path
                                d="M16.24,3.56L21.19,8.5C21.97,9.29 21.97,10.55 21.19,11.34L12,20.53C10.44,22.09 7.91,22.09 6.34,20.53L2.81,17C2.03,16.21 2.03,14.95 2.81,14.16L13.41,3.56C14.2,2.78 15.46,2.78 16.24,3.56M4.22,15.58L7.76,19.11C8.54,19.9 9.8,19.9 10.59,19.11L14.12,15.58L9.17,10.63L4.22,15.58Z" />
                        </svg>
                        Erase Content
                    </button>

                    <div class="submenu-container">
                        <button class="dropdown-btn" style="width:100%; justify-content: space-between;">
                            <div style="display:flex; align-items:center; gap:8px;">
                                <svg viewBox="0 0 24 24">
                                    <path
                                        d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" />
                                </svg>
                                Erase Edits
                            </div>
                            <span style="font-size: 10px;">▶</span>
                        </button>
                        <div class="submenu-content">
                            <button class="dropdown-btn" onclick="setTool('eraser-edit-pencil')">Pen</button>
                            <button class="dropdown-btn"
                                onclick="setTool('eraser-edit-highlighter')">Highlighter</button>
                            <button class="dropdown-btn" onclick="setTool('eraser-edit-arrow')">Arrow</button>
                            <button class="dropdown-btn" onclick="setTool('eraser-edit-image')">Image</button>
                            <button class="dropdown-btn" onclick="setTool('eraser-edit-whiteout')">Whiteout</button>
                        </div>
                    </div>

                    <button class="dropdown-btn" id="tool-eraser-clear" onclick="clearAllAnnotations()">
                        <svg viewBox="0 0 24 24">
                            <path
                                d="M19.36,2.72L20.78,4.14L15.06,9.85C16.13,11.39 16.28,13.24 15.38,14.44L9.06,8.12C10.26,7.22 12.11,7.37 13.65,8.44L19.36,2.72M5.93,17.57C3.92,15.56 2.69,13.16 2.35,10.92L7.23,8.83L14.67,16.27L12.58,21.15C10.34,20.81 7.94,19.58 5.93,17.57Z" />
                        </svg>
                        Clear All
                    </button>
                </div>
            </div>

        </div>

        <div class="toolbar-right">
            <button class="tool-btn" onclick="editorApp.calculatePdfSize()" title="Refresh Size"
                style="margin-right: 5px;">
                <svg viewBox="0 0 24 24" style="width:18px;height:18px;">
                    <path
                        d="M12,18A6,6 0 0,1 6,12C6,11 6.25,10.03 6.7,9.2L5.24,7.74C4.46,8.97 4,10.43 4,12A8,8 0 0,0 12,20V23L16,19L12,15V18M12,4V1L8,5L12,9V6A6,6 0 0,1 18,12C18,13 17.75,13.97 17.3,14.8L18.76,16.26C19.54,15.03 20,13.57 20,12A8,8 0 0,0 12,4Z" />
                </svg>
            </button>
            <span id="pdf-size-display" class="loading-dots"
                style="margin-right:15px; font-size:14px; color:#a0ecff; font-weight:500; font-family: 'Rajdhani', sans-serif; letter-spacing: 0.5px;">Loading...</span>
            <button class="tool-btn"
                style="width:auto; padding:0 12px; margin-right:8px; font-size:14px; display:inline-flex; align-items:center; height:36px;"
                onclick="showCompressionModal()" title="Compress">
                <svg viewBox="0 0 24 24" style="width:16px; height:16px; margin-right:4px;">
                    <path
                        d="M4,2H20A2,2 0 0,1 22,4V16A2,2 0 0,1 20,18H16L12,22L8,18H4A2,2 0 0,1 2,16V4A2,2 0 0,1 4,2M4,4V16H8.83L12,19.17L15.17,16H20V4H4M12,8L16,12H13V14H11V12H8L12,8Z" />
                </svg>
                Compress
            </button>
            <button class="tool-btn"
                style="width:auto; padding:0 12px; margin-right:8px; font-size:14px; display:inline-flex; align-items:center; height:36px; background: rgba(0, 213, 255, 0.1); border: 1px solid rgba(0, 213, 255, 0.4); color: #a0ecff;"
                onclick="editorApp.saveToVault()" id="save-vault-btn" title="Save to Vault">
                <svg viewBox="0 0 24 24" style="width:16px; height:16px; margin-right:4px;">
                    <path d="M17,3H7C5.89,3 5,3.9 5,5V21L12,18L19,21V5C19,3.9 18.1,3 17,3Z" />
                </svg>
                Save Progress
            </button>
            <button class="done-btn-editor" id="done-btn" onclick="editorApp.saveAndDownloadPDF()">Done</button>
        </div>

    </div>

    <!-- Main Layout -->
    <div class="editor-container">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">Pages</div>
            <div id="sidebarItems" class="sidebar-items">
                <!-- Thumbnails generated by JS -->
            </div>
            <div class="add-page-box">
                <button class="add-page-btn" onclick="addNewPage()">+ Add Page</button>
            </div>
        </div>

        <div class="main-canvas" id="mainCanvas">
            <div id="pdfContainer" class="pdf-container">
                <!-- Pages rendered by JS -->
            </div>
        </div>
    </div>

    <!-- Compression Modal -->
    <style>
        /* Force Dark Mode on Select Options */
        #compressionModal option {
            background-color: #050f19;
            color: #a0ecff;
            padding: 8px;
        }

        #compressionModal select:focus {
            outline: none;
            border-color: #00d5ff !important;
            box-shadow: 0 0 10px rgba(0, 213, 255, 0.3);
        }
    </style>
    <div id="compressionModal" class="modal-overlay"
        style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:10001; justify-content:center; align-items:center; backdrop-filter: blur(5px);">
        <div class="modal-content"
            style="background: rgba(5, 15, 25, 0.95); backdrop-filter: blur(12px); padding:20px; border-radius:8px; width:400px; max-width:90%; border: 1px solid rgba(0, 213, 255, 0.3); box-shadow: 0 0 30px rgba(0, 213, 255, 0.2); color: #a0ecff;">
            <h3 style="margin-top:0; color: #00d5ff; font-family: 'Rajdhani', sans-serif; text-transform: uppercase;">
                Compress PDF</h3>
            <p style="font-size:14px; color:#a0ecff;">Choose a compression level. Note: This will rasterize text (making
                it
                non-selectable) to reduce file size.</p>

            <!-- Target Size Selection -->
            <div id="compressionOptions" style="color: #a0ecff; font-family: 'Rajdhani', sans-serif;">
                <!-- Mode Switch -->
                <div style="margin-bottom:15px; padding-bottom:10px; border-bottom:1px solid rgba(0, 213, 255, 0.2);">
                    <label style="cursor:pointer; display:flex; align-items:center;">
                        <input type="checkbox" id="useWasm" onchange="toggleCompressionMode()"
                            style="accent-color: #00d5ff; cursor: pointer;">
                        <span
                            style="font-weight:bold; margin-left:8px; text-transform: uppercase; letter-spacing: 1px;">Use
                            High Quality (Preserves Text)</span>
                    </label>
                    <div style="font-size:11px; color:#00aaa0; margin-left:24px; margin-top: 4px;">Experimental: Uses
                        Ghostscript WASM to
                        compress without rasterization.</div>
                </div>

                <!-- Raster Options (Default) -->
                <div id="rasterOptions">
                    <label
                        style="display:block; font-weight:bold; margin-bottom:10px; text-transform: uppercase;">Target
                        File Size
                        (Raster):</label>

                    <div style="display:flex; gap:15px; margin-bottom:15px;">
                        <label
                            style="cursor:pointer; display:flex; align-items:center; background: rgba(0, 213, 255, 0.1); padding: 5px 10px; border: 1px solid rgba(0, 213, 255, 0.2); border-radius: 4px;">
                            <input type="radio" name="sizeUnit" value="KB" checked onclick="toggleSizeOptions()"
                                style="accent-color: #00d5ff;">
                            <span style="margin-left:5px; font-weight: bold;">KB</span>
                        </label>
                        <label
                            style="cursor:pointer; display:flex; align-items:center; background: rgba(0, 213, 255, 0.1); padding: 5px 10px; border: 1px solid rgba(0, 213, 255, 0.2); border-radius: 4px;">
                            <input type="radio" name="sizeUnit" value="MB" onclick="toggleSizeOptions()"
                                style="accent-color: #00d5ff;">
                            <span style="margin-left:5px; font-weight: bold;">MB</span>
                        </label>
                    </div>

                    <div id="kbOptions">
                        <select id="targetValueKB"
                            style="width:100%; padding:8px; background: rgba(0, 10, 20, 0.8); border:1px solid rgba(0, 213, 255, 0.4); border-radius:4px; color: #fff; font-family: 'Rajdhani', sans-serif;">
                            <option value="100">100 KB</option>
                            <option value="200">200 KB</option>
                            <option value="300">300 KB</option>
                            <option value="400">400 KB</option>
                            <option value="500" selected>500 KB</option>
                            <option value="600">600 KB</option>
                            <option value="700">700 KB</option>
                            <option value="800">800 KB</option>
                            <option value="900">900 KB</option>
                            <option value="1000">1000 KB</option>
                        </select>
                    </div>

                    <div id="mbOptions" style="display:none;">
                        <select id="targetValueMB"
                            style="width:100%; padding:8px; background: rgba(0, 10, 20, 0.8); border:1px solid rgba(0, 213, 255, 0.4); border-radius:4px; color: #fff; font-family: 'Rajdhani', sans-serif;">
                            <option value="1">1 MB</option>
                            <option value="2">2 MB</option>
                            <option value="5">5 MB</option>
                            <option value="10">10 MB</option>
                            <option value="15">15 MB</option>
                            <option value="20">20 MB</option>
                            <option value="25">25 MB</option>
                            <option value="30">30 MB</option>
                        </select>
                    </div>

                    <div
                        style="font-size:12px; color:#ffdd57; margin-top:10px; background:rgba(255, 200, 0, 0.1); padding:8px; border-radius:4px; border: 1px dashed rgba(255, 200, 0, 0.3);">
                        <span style="font-weight:bold;">NOTE:</span> Text will be rasterized (non-selectable) to achieve
                        this compression.
                    </div>
                </div>

                <!-- WASM Options -->
                <div id="wasmOptions" style="display:none;">
                    <label
                        style="display:block; font-weight:bold; margin-bottom:10px; text-transform: uppercase;">Compression
                        Level:</label>
                    <select id="wasmPreset"
                        style="width:100%; padding:8px; background: rgba(0, 10, 20, 0.8); border:1px solid rgba(0, 213, 255, 0.4); border-radius:4px; color: #fff; font-family: 'Rajdhani', sans-serif;">
                        <option value="/screen">Screen (72 dpi) - Smallest</option>
                        <option value="/ebook">Ebook (150 dpi) - Medium</option>
                        <option value="/printer">Printer (300 dpi) - High Quality</option>
                    </select>

                    <!-- Greyscale Conversion Option -->
                    <div
                        style="margin-top: 15px; padding: 12px; background: rgba(0, 213, 255, 0.05); border: 1px solid rgba(0, 213, 255, 0.2); border-radius: 4px;">
                        <label style="display:flex; align-items:center; cursor:pointer;">
                            <input type="checkbox" id="wasmGreyscale"
                                style="accent-color: #00d5ff; width: 18px; height: 18px; cursor: pointer;">
                            <span
                                style="margin-left: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Convert
                                to Greyscale</span>
                        </label>
                        <div style="font-size: 11px; color: #6dd5ed; margin-top: 6px; margin-left: 28px;">
                            Reduces file size by removing color information
                        </div>
                    </div>

                    <div
                        style="font-size:12px; color:#00ffaa; margin-top:10px; background:rgba(0, 255, 170, 0.1); padding:8px; border-radius:4px; border: 1px dashed rgba(0, 255, 170, 0.3);">
                        <span style="font-weight:bold;">HIGH QUALITY:</span> Maintains text selectability and sharp
                        vectors.
                    </div>
                </div>
            </div>

            <script>
                function toggleSizeOptions() {
                    const unit = document.querySelector('input[name="sizeUnit"]:checked').value;
                    document.getElementById('kbOptions').style.display = unit === 'KB' ? 'block' : 'none';
                    document.getElementById('mbOptions').style.display = unit === 'MB' ? 'block' : 'none';
                }

                function toggleCompressionMode() {
                    const useWasm = document.getElementById('useWasm').checked;
                    document.getElementById('rasterOptions').style.display = useWasm ? 'none' : 'block';
                    document.getElementById('wasmOptions').style.display = useWasm ? 'block' : 'none';
                }
            </script>

            <!-- Progress -->
            <!-- Progress -->
            <div id="compressionProgress"
                style="display:none; margin-bottom:15px; font-family: 'Rajdhani', sans-serif;">
                <div
                    style="background:rgba(0, 213, 255, 0.1); height:14px; border: 1px solid rgba(0, 213, 255, 0.3); border-radius:2px; overflow:hidden; position: relative;">
                    <div id="compressionProgressBar"
                        style="width:0%; height:100%; background: linear-gradient(90deg, #00d5ff, #0077ff); box-shadow: 0 0 15px rgba(0, 213, 255, 0.8); transition:width 0.2s;">
                    </div>
                </div>
                <div id="compressionProgressText"
                    style="text-align:center; font-size:12px; margin-top:8px; color: #a0ecff; text-transform: uppercase; letter-spacing: 2px; text-shadow: 0 0 5px rgba(0, 213, 255, 0.5);">
                    Processing Data Stream...</div>
            </div>

            <div class="modal-footer-btns"
                style="text-align:right; display:flex; justify-content:flex-end; gap:10px; border-top: 1px solid rgba(0, 213, 255, 0.2); padding-top: 15px;">
                <button onclick="closeCompressionModal()"
                    style="padding:8px 20px; border:1px solid rgba(0, 213, 255, 0.3); background:rgba(0, 213, 255, 0.1); color:#a0ecff; border-radius:4px; cursor:pointer; font-family: 'Rajdhani', sans-serif; text-transform: uppercase;">Cancel</button>
                <button onclick="startCompression()"
                    style="padding:8px 20px; border:1px solid #00d5ff; background:rgba(0, 213, 255, 0.3); color:white; border-radius:4px; cursor:pointer; font-family: 'Rajdhani', sans-serif; text-transform: uppercase; box-shadow: 0 0 10px rgba(0, 213, 255, 0.3); font-weight: bold;">
                    Initiate Compression
                </button>
            </div>
        </div>
    </div>

    <!-- MERGE PDF MODAL -->
    <div id="mergeModal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="width: 550px; max-width: 90vw;">
            <div class="modal-header">
                <h3
                    style="margin:0; color:#00d5ff; font-family:'Rajdhani', sans-serif; text-transform:uppercase; letter-spacing:1px;">
                    Insert PDF Pages</h3>
                <button class="icon-btn" onclick="closeMergeModal()"
                    style="color:#fff; font-size: 24px; background: transparent; border: none; cursor: pointer;">×</button>
            </div>

            <div class="modal-body" style="padding: 20px;">
                <div
                    style="margin-bottom: 20px; padding: 12px; background: rgba(0, 213, 255, 0.1); border-radius: 4px; border-left: 3px solid #00d5ff;">
                    <span
                        style="font-size: 11px; color: #a0ecff; display: block; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 1px;">Selected
                        File</span>
                    <span id="mergeFileName"
                        style="color: #fff; font-weight: bold; font-family: 'Rajdhani', sans-serif; font-size: 16px;">document.pdf</span>
                    <span id="mergePageCount"
                        style="color: #00d5ff; font-size: 12px; margin-left: 10px;">(loading...)</span>
                </div>

                <!-- Merge Mode Selection -->
                <div style="margin-bottom: 20px;">
                    <label
                        style="display:flex; align-items:center; padding: 12px; background: rgba(0, 213, 255, 0.05); border: 1px solid rgba(0, 213, 255, 0.2); border-radius: 4px; margin-bottom: 10px; cursor: pointer; transition: all 0.2s;">
                        <input type="radio" name="mergeType" value="all" checked onchange="toggleMergeOptions()"
                            style="accent-color: #00d5ff; width: 18px; height: 18px;">
                        <div style="margin-left: 12px; flex: 1;">
                            <span style="color: #fff; font-weight: 600; display: block; font-size: 14px;">Merge Entire
                                PDF</span>
                            <span style="color: #a0ecff; font-size: 11px;">Insert all pages from the selected
                                file</span>
                        </div>
                    </label>

                    <label
                        style="display:flex; align-items:center; padding: 12px; background: rgba(0, 213, 255, 0.05); border: 1px solid rgba(0, 213, 255, 0.2); border-radius: 4px; cursor: pointer; transition: all 0.2s;">
                        <input type="radio" name="mergeType" value="specific" onchange="toggleMergeOptions()"
                            style="accent-color: #00d5ff; width: 18px; height: 18px;">
                        <div style="margin-left: 12px; flex: 1;">
                            <span style="color: #fff; font-weight: 600; display: block; font-size: 14px;">Add Specific
                                Pages</span>
                            <span style="color: #a0ecff; font-size: 11px;">Choose individual pages or ranges to
                                insert</span>
                        </div>
                    </label>
                </div>

                <!-- Specific Page Options -->
                <div id="mergeSpecificOptions"
                    style="display: none; padding: 15px; background: rgba(0, 10, 20, 0.6); border: 1px solid rgba(0, 213, 255, 0.3); border-radius: 4px;">
                    <label
                        style="display: block; color: #00d5ff; font-size: 12px; margin-bottom: 8px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px;">Page
                        Selection</label>

                    <input type="text" id="mergePageRange" placeholder="e.g., 1, 3-5, 8, 10-12"
                        style="width: 100%; padding: 10px; background: rgba(0, 10, 20, 0.9); border: 1px solid rgba(0, 213, 255, 0.4); color: #fff; border-radius: 4px; font-family: 'Rajdhani', sans-serif; font-size: 14px; margin-bottom: 10px;">

                    <div style="font-size: 11px; color: #6dd5ed; line-height: 1.5;">
                        <div style="margin-bottom: 5px;"><strong style="color: #00d5ff;">Examples:</strong></div>
                        <div>• Single page: <code
                                style="background: rgba(0,213,255,0.1); padding: 2px 6px; border-radius: 2px;">5</code>
                        </div>
                        <div>• Range: <code
                                style="background: rgba(0,213,255,0.1); padding: 2px 6px; border-radius: 2px;">3-7</code>
                        </div>
                        <div>• Multiple: <code
                                style="background: rgba(0,213,255,0.1); padding: 2px 6px; border-radius: 2px;">1, 4-6, 9</code>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer-btns"
                style="padding: 15px 20px; border-top: 1px solid rgba(0, 213, 255, 0.2); display: flex; gap: 10px; justify-content: flex-end;">
                <button onclick="closeMergeModal()"
                    style="padding: 10px 20px; background: transparent; border: 1px solid rgba(255, 255, 255, 0.2); color: #a0ecff; cursor: pointer; border-radius: 4px; font-family: 'Rajdhani', sans-serif; text-transform: uppercase; transition: all 0.2s;">Cancel</button>
                <button onclick="executeMerge()"
                    style="padding: 10px 25px; background: linear-gradient(135deg, #00d5ff, #0088ff); border: none; color: #000; font-weight: bold; cursor: pointer; border-radius: 4px; font-family: 'Rajdhani', sans-serif; text-transform: uppercase; box-shadow: 0 0 15px rgba(0, 213, 255, 0.4); transition: all 0.2s;">
                    Insert Pages
                </button>
            </div>
        </div>
    </div>

    <script type="module" src="js/pdf-editor/PDFEditor.js?v="></script>
</body>

</html>
<script>
    document.addEventListener('mousemove', (e) => {
        const glow = document.getElementById('pointerGlow');
        if (glow) {
            glow.style.setProperty('--mouse-x', e.clientX + 'px');
            glow.style.setProperty('--mouse-y', e.clientY + 'px');
        }
    });
</script>
